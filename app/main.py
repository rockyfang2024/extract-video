from flask import Flask, request, send_from_directory, jsonify\nfrom bs4 import BeautifulSoup\nimport yt_dlp\nimport os\n\napp = Flask(__name__)\nDOWNLOAD_FOLDER = 'downloads'\napp.config['DOWNLOAD_FOLDER'] = DOWNLOAD_FOLDER\n\nif not os.path.exists(DOWNLOAD_FOLDER):\n    os.makedirs(DOWNLOAD_FOLDER)\n\n@app.route('/api/extract', methods=['POST'])\ndef extract_video():\n    data = request.json\n    url = data.get('url')\n    if not url:\n        return jsonify({'error': 'No URL provided'}), 400\n    \n    ydl_opts = {\n        'format': 'best',\n        'noplaylist': True,\n    }\n    with yt_dlp.YoutubeDL(ydl_opts) as ydl:\n        info_dict = ydl.extract_info(url, download=False)\n        title = info_dict.get('title', None)\n        video_url = info_dict.get('url', None)\n        return jsonify({'title': title, 'video_url': video_url})\n\n@app.route('/api/download', methods=['POST'])\ndef download_video():\n    data = request.json\n    url = data.get('url')\n    if not url:\n        return jsonify({'error': 'No URL provided'}), 400\n    \n    ydl_opts = {\n        'format': 'best',\n        'outtmpl': os.path.join(app.config['DOWNLOAD_FOLDER'], '%(title)s.%(ext)s'),\n        'noplaylist': True,\n    }\n    with yt_dlp.YoutubeDL(ydl_opts) as ydl:\n        ydl.download([url])\n        return jsonify({'message': 'Video downloaded successfully'}), 200\n\n@app.route('/api/videos', methods=['GET'])\ndef list_videos():\n    files = os.listdir(app.config['DOWNLOAD_FOLDER'])\n    return jsonify(files)\n\n@app.route('/downloads/<filename>', methods=['GET'])\ndef download_file(filename):\n    return send_from_directory(app.config['DOWNLOAD_FOLDER'], filename)\n\nif __name__ == '__main__':\n    app.run(debug=True, host='0.0.0.0')\n